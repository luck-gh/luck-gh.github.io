{"title":"ARM_02_环境搭建","slug":"ARM/ARM_02","date":"2018-02-03T05:35:42.000Z","updated":"2018-06-06T12:02:20.345Z","comments":true,"path":"api/articles/ARM/ARM_02.json","photos":[],"link":"","excerpt":"1 交叉编译工具的安装 √<br>2 编译Uboot √<br>3 安装Kermit √<br>4 Minicom √<br>5 Uboot的命令 √<br>6 Dnw工具的安装 √<br>7 往Emmc烧写Uboot √","covers":["https://wx4.sinaimg.cn/mw690/0079ID0Dly1frzifvzrz0j30bq09ngnl.jpg"],"content":"<p><strong>1 交叉编译工具的安装</strong> √<br><strong>2 编译Uboot</strong> √<br><strong>3 安装Kermit</strong> √<br><strong>4 Minicom</strong> √<br><strong>5 Uboot的命令</strong> √<br><strong>6 Dnw工具的安装</strong> √<br><strong>7 往Emmc烧写Uboot</strong> √</p>\n<a id=\"more\"></a>\n<hr>\n<hr>\n<h1 id=\"一-交叉编译工具的安装\"><a href=\"#一-交叉编译工具的安装\" class=\"headerlink\" title=\"一. 交叉编译工具的安装\"></a>一. 交叉编译工具的安装</h1><ul>\n<li><p><strong>安装交叉编译工具到<code>/opt</code></strong></p>\n<blockquote>\n<p>解压tar包</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:~]$ <span class=\"built_in\">cd</span>  /opt/</span><br><span class=\"line\">[GH@Ubuntu:~]$ mv  FriendlyARM/toolchains  /opt/</span><br></pre></td></tr></table></figure>\n</blockquote>\n</li>\n<li><p><strong>修改环境变量</strong></p>\n<blockquote>\n<p>修改文件<code>.bashrc</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:~]$ sudo  vim ~/.bashrc</span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n<p>修改如下内容<br><code>export  PATH=/opt/toolchains/4.5.1/bin:$PATH</code></p>\n</blockquote>\n</li>\n<li><p><strong>重新打开一个终端测试</strong></p>\n<blockquote>\n<p>在终端中输入如下</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:~]$ arm-linux-gcc  -v</span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n<p>看到编译工具的版本号则成功，如果找不到工具，可能环境变量添加有问题。</p>\n<ul>\n<li>可能少库文件尝试如下：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:~]$ sudo  apt-get  install  lsb-core</span><br><span class=\"line\">[GH@Ubuntu:~]$ sudo  apt-get  install  lib32z1</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</blockquote>\n</li>\n</ul>\n<hr>\n<h1 id=\"二-编译Uboot\"><a href=\"#二-编译Uboot\" class=\"headerlink\" title=\"二. 编译Uboot\"></a>二. 编译Uboot</h1><ul>\n<li><p><strong>解压</strong></p>\n<blockquote>\n<p>解压关键文件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:uboot]$ tar  -jxvf  uboot_tiny4412.tar.bz2</span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n<p>配置uboot</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:uboot_tiny4412]$ make  tiny4412_config</span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n<p><code>include</code>目录下会生成编译<code>Uboot</code>需要的配置文件<code>config.mk</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:uboot_tiny4412]$ make</span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n<ul>\n<li>备注：<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DDR SDRAM         ：1G，0X40000000 ～ 0X80000000</span><br><span class=\"line\">UBOOT  BASEADDRESS：0X43e00000</span><br><span class=\"line\">KERNEL BASEADDRESS：0X40008000</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</blockquote>\n</li>\n<li><p><strong>烧写<code>Uboot</code>到sd卡</strong></p>\n<blockquote>\n<p>如果你的sd卡的设备文件是<code>/dev/sdb</code>, 那么</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:tiny4412]$  sudo  ./sd_fusing.sh  /dev/sdb</span><br></pre></td></tr></table></figure>\n</blockquote>\n</li>\n</ul>\n<hr>\n<h1 id=\"三-安装Kermit\"><a href=\"#三-安装Kermit\" class=\"headerlink\" title=\"三. 安装Kermit\"></a>三. 安装Kermit</h1><ul>\n<li><p><strong>什么是<code>Kermit</code></strong></p>\n<blockquote>\n<p>开发板和PC通过串口相连，板子的调试信息需要通过串口传输<br>显示到PC端。PC端需要安装串口监视软件比如：<code>minicom</code>，<code>kermit</code>。</p>\n</blockquote>\n</li>\n<li><p><strong><code>kermit</code>的安装</strong></p>\n<blockquote>\n<p>联网安装</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:tiny4412]$ sudo  apt-get  install  ckermit</span><br></pre></td></tr></table></figure>\n</blockquote>\n</li>\n<li><p><strong>配置</strong></p>\n<blockquote>\n<p>修改配置文件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:tiny4412]$ vim  ~/.kermrc</span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n<p>修改如下:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set line\t\t/dev/ttyUSB0</span><br><span class=\"line\">set speed\t\t115200</span><br><span class=\"line\">set carrier-watch\toff</span><br><span class=\"line\">set handshake\t\tnone</span><br><span class=\"line\">set flow-control\tnone</span><br><span class=\"line\">robust</span><br><span class=\"line\">set file type\t\tbin</span><br><span class=\"line\">set file name\t\tlit</span><br><span class=\"line\">set rec pack\t\t1000</span><br><span class=\"line\">set send pack\t\t1000</span><br><span class=\"line\">set window\t\t5</span><br></pre></td></tr></table></figure>\n</blockquote>\n</li>\n</ul>\n<hr>\n<h1 id=\"四-Minicom\"><a href=\"#四-Minicom\" class=\"headerlink\" title=\"四. Minicom\"></a>四. Minicom</h1><ul>\n<li><p><strong>安装</strong></p>\n<blockquote>\n<p>联网安装</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:tiny4412]$ sudo  apt-get  install  minicom</span><br></pre></td></tr></table></figure>\n</blockquote>\n</li>\n<li><p><strong>配置</strong></p>\n<blockquote>\n<p>程序自带配置</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:tiny4412]$ sudo  minicom  -s</span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n<p>退出<code>minicom</code>： <code>ctrl + A + q</code><br>打开自动换行的命令是： <code>ctrl + a + w</code><br><img src=\"https://wx4.sinaimg.cn/mw690/0079ID0Dly1frzifvzrz0j30bq09ngnl.jpg\" alt=\"配置图1\"><br><img src=\"https://wx1.sinaimg.cn/mw690/0079ID0Dly1frzifw0g3bj30ic0f6dj9.jpg\" alt=\"配置图2\"></p>\n</blockquote>\n</li>\n</ul>\n<hr>\n<h1 id=\"五-Uboot的命令\"><a href=\"#五-Uboot的命令\" class=\"headerlink\" title=\"五. Uboot的命令\"></a>五. Uboot的命令</h1><ul>\n<li><p><strong>printenv</strong><br>打印环境变量的命令</p>\n</li>\n<li><p><strong>set   varname   val</strong><br>设置环境变量的命令是<br><code>eg：[GH@Uboot]# set  bootdelay  5</code></p>\n</li>\n<li><p><strong>saveenv</strong><br>保存环境变量的命令</p>\n</li>\n<li><p><strong>reset</strong><br>软件复位</p>\n</li>\n<li><p><strong>?/help</strong><br>查看命令帮助</p>\n</li>\n<li><p><strong>mmc  list</strong><br>列出所有mmc接口的设备编号</p>\n</li>\n<li><p><strong>mmcinfo</strong><br>查看某个编号的mmc接口设备的详细信息的</p>\n</li>\n<li><p><strong>fdisk</strong><br>fdisk  -p   devnum<br>fdisk  -c    devnum   [分区2的大小]  [分区3的大小] [分区4的大小]</p>\n</li>\n<li><p><strong>fatformat/ext3format</strong></p>\n</li>\n<li><p><strong>dnw   address</strong></p>\n</li>\n<li><p><strong>mmc    write   devnum   memaddress    startblknum    blkcnt</strong></p>\n</li>\n</ul>\n<hr>\n<h1 id=\"六-Dnw工具的安装\"><a href=\"#六-Dnw工具的安装\" class=\"headerlink\" title=\"六. Dnw工具的安装\"></a>六. Dnw工具的安装</h1><ul>\n<li><p><strong>拷贝<code>dnw</code>命令需要的配置文件</strong></p>\n<blockquote>\n<p>拷贝文件到目标目录</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:dnw-linux]$ sudo  cp  dnw.rules  /etc/udev/rules.d/</span><br></pre></td></tr></table></figure>\n</blockquote>\n</li>\n<li><p><strong>驱动的编译安装</strong></p>\n<blockquote>\n<p>进入<code>src</code>目录下的<code>driver</code>目录下修改<code>Makefile</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">obj-m := secbulk.o</span><br><span class=\"line\">KERNEL  := /lib/modules/`uname -r`/build/</span><br><span class=\"line\">all:</span><br><span class=\"line\">\tmake  -C  $(KERNEL) M=`pwd` modules</span><br><span class=\"line\">clean:</span><br><span class=\"line\">\tmake  -C  $(KERNEL) M=`pwd` clean</span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n<p>编译：<br><code>make</code> 即可<br>最后生成的<code>secbulk.ko</code>就是我们需要的驱动模块。<br>向内核插入驱动模块并运行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:tiny4412]$ sudo  insmod secbulk.ko</span><br></pre></td></tr></table></figure>\n</blockquote>\n</li>\n<li><p><strong>安装命令</strong></p>\n<blockquote>\n<p>进入<code>dnw</code>目录<code>make</code>，然后拷贝<code>dnw</code>命令到如下路径：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:dnw]$ sudo  cp  dnw  /usr/bin/</span><br></pre></td></tr></table></figure>\n</blockquote>\n</li>\n</ul>\n<hr>\n<h1 id=\"七-往Emmc烧写Uboot\"><a href=\"#七-往Emmc烧写Uboot\" class=\"headerlink\" title=\"七. 往Emmc烧写Uboot\"></a>七. 往Emmc烧写Uboot</h1><ul>\n<li><p><strong>分区</strong></p>\n<blockquote>\n<p><code>emmc</code>, <code>sd</code>卡都是利用<code>mmc</code>接口和主控制器<code>exynos4412</code>相连。利用<code>Uboot</code>支持的命令<code>mmc list</code>和<code>mmcinfo</code> 确定<code>emmc</code>的编号。<br>根据操作可知编号为1的是4G大小的emmc。<br>格式化四个分区：分别格式为一个fat32和3个ext3。<br>按照上图方法格式化。烧写uboot之前首先要打开emmc</p>\n</blockquote>\n</li>\n<li><p><strong>烧写文件</strong></p>\n<blockquote>\n<p>开发板端请求下载：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Uboot]$ dnw 50000000</span><br><span class=\"line\">//50000000为数据下载地址起始位置</span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n<p>PC端发送：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Ubuntu:~]$ sudo dnw xxx.bin</span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n<p>开发板端烧：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[Laomi@Uboot]$ mmc write 1 50000000 0 10</span><br><span class=\"line\">//一个文件从50000000 + 0 开始烧写</span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n<p>烧写完uboot的四个文件后必须关闭emmc，在uboot命令行执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[GH@Uboot]$ emmc  close  1</span><br></pre></td></tr></table></figure>\n</blockquote>\n</li>\n</ul>\n","categories":[{"name":"嵌入式","slug":"嵌入式","count":3,"path":"api/categories/嵌入式.json"}],"tags":[{"name":"ARM","slug":"ARM","count":3,"path":"api/tags/ARM.json"}]}